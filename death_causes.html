<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>5 อันดับสาเหตุการเสียชีวิตรายปี</title>
<style>
body { margin:0; font-family:sans-serif; background: linear-gradient(to right, rgb(55,194,115), rgb(183,226,196)); }
header { text-align:center; padding:30px 20px; }
main { padding:20px; max-width:900px; margin:auto; background-color: rgba(255,255,255,0.9); border-radius:12px; }
a.back { display:inline-block; margin-bottom:20px; color:navy; text-decoration:none; font-weight:bold; }
label { font-weight:bold; margin-right:10px; }
select { padding:6px 10px; border-radius:6px; border:1px solid #333; }
table { width:100%; border-collapse: collapse; margin-top:15px; }
th, td { padding:12px; text-align:center; border:1px solid #333; }
th { background-color: rgb(4,44,24); color:white; }
tr:nth-child(even) { background-color: rgba(0,0,0,0.05); }
</style>
</head>
<body>
<header>
    <h1>5 อันดับสาเหตุการเสียชีวิตรายปี</h1>
</header>
<main>
<a href="index.html" class="back">&larr; กลับหน้าหลัก</a>

<div style="margin-bottom:20px;">
  <label for="yearSelect">เลือกปี:</label>
  <select id="yearSelect">
    <option value="y2566">2566</option>
    <option value="y2567">2567</option>
    <option value="y2568" selected>2568</option>
  </select>
</div>

<div id="y2566" class="yearTable" style="display:none;">
<h2>ปี 2566</h2>
<table>
<thead><tr><th>อันดับ</th><th>สาเหตุการเสียชีวิต</th><th>จำนวนผู้เสียชีวิต</th></tr></thead>
<tbody>
<tr><td>1</td><td>ตายไม่ทราบสาเหตุ</td><td>10</td></tr>
<tr><td>2</td><td>Pneumonia</td><td>7</td></tr>
<tr><td>3</td><td>จมน้ำ</td><td>7</td></tr>
<tr><td>4</td><td>Sepsis</td><td>5</td></tr>
<tr><td>5</td><td>Myocardial infarction</td><td>5</td></tr>
</tbody>
</table>
</div>

<div id="y2567" class="yearTable" style="display:none;">
<h2>ปี 2567</h2>
<table>
<thead><tr><th>อันดับ</th><th>สาเหตุการเสียชีวิต</th><th>จำนวนผู้เสียชีวิต</th></tr></thead>
<tbody>
<tr><td>1</td><td>Sepsis</td><td>28</td></tr>
<tr><td>2</td><td>Stroke</td><td>15</td></tr>
<tr><td>3</td><td>Pneumonia</td><td>10</td></tr>
<tr><td>4</td><td>Cancer</td><td>10</td></tr>
<tr><td>5</td><td>Gastrointestinal Bleeding</td><td>9</td></tr>
</tbody>
</table>
</div>

<div id="y2568" class="yearTable">
<h2>ปี 2568</h2>
<div id="sheetTable">⏳ กำลังโหลดข้อมูล...</div>
</div>

</main>

<script>
document.getElementById("yearSelect").addEventListener("change", function(){
  document.querySelectorAll(".yearTable").forEach(div => div.style.display="none");
  document.getElementById(this.value).style.display="block";
});

const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQkeNpfWKavDklihMocnMbZtI4nub9OYOTJ4Y5ceK7ThGmnVTYm0wmyumDjx6wqLbs6JLV2Yna6872o/pub?gid=0&single=true&output=csv";

fetch(sheetURL)
  .then(response => response.text())
  .then(data => {
    const rows = data.trim().split("\n").map(r => r.split(","));
    let html = "<table><thead><tr>";
    rows[0].forEach(col => html += `<th>${col}</th>`);
    html += "</tr></thead><tbody>";
    rows.slice(1).forEach(r => {
      html += "<tr>";
      r.forEach(c => html += `<td>${c}</td>`);
      html += "</tr>";
    });
    html += "</tbody></table>";
    document.getElementById("sheetTable").innerHTML = html;
  })
  .catch(err => {
    document.getElementById("sheetTable").innerHTML = "⚠️ โหลดข้อมูลไม่สำเร็จ";
    console.error(err);
  });
</script>

</body>
</html>
